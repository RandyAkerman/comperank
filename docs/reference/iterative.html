<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Iterative rating method — iterative • comperes</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  <script src="../extra.js"></script>
<meta property="og:title" content="Iterative rating method — iterative" />

<meta property="og:description" content="Functions to compute Iterative numeric ratings, i.e. which
are recomputed after every game, and corresponding
rankings." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">comperank</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/methods-overview.html">Methods Overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/echasnovski/comperank">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Iterative rating method</h1>
    <small class="dont-index">Source: <a href='https://github.com/echasnovski/comperank/blob/master/R/iterative.R'><code>R/iterative.R</code></a></small>
    <div class="hidden name"><code>iterative.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Functions to compute Iterative numeric <a href='rating-ranking.html'>ratings</a>, i.e. which
are recomputed after every game, and corresponding
<a href='rating-ranking.html'>rankings</a>.</p>
    
    </div>

    <pre class="usage"><code class = "r"><span class='fu'>rate_iterative</span>(<span class='no'>cr_data</span>, <span class='no'>rate_fun</span>, <span class='kw'>initial_ratings</span> <span class='kw'>=</span> <span class='fl'>0</span>)

<span class='fu'>rank_iterative</span>(<span class='no'>cr_data</span>, <span class='no'>rate_fun</span>, <span class='kw'>initial_ratings</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>keep_rating</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"desc"</span>, <span class='kw'>ties</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"average"</span>, <span class='st'>"first"</span>, <span class='st'>"last"</span>, <span class='st'>"random"</span>, <span class='st'>"max"</span>,
  <span class='st'>"min"</span>), <span class='kw'>round_digits</span> <span class='kw'>=</span> <span class='fl'>7</span>)

<span class='fu'>add_iterative_ratings</span>(<span class='no'>cr_data</span>, <span class='no'>rate_fun</span>, <span class='kw'>initial_ratings</span> <span class='kw'>=</span> <span class='fl'>0</span>)</code></pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cr_data</th>
      <td><p>Competition results in format ready for
<a href='http://www.rdocumentation.org/packages/comperes/topics/longcr'>as_longcr()</a>.</p></td>
    </tr>
    <tr>
      <th>rate_fun</th>
      <td><p>Rating function (see Details).</p></td>
    </tr>
    <tr>
      <th>initial_ratings</th>
      <td><p>Initial ratings (see Details).</p></td>
    </tr>
    <tr>
      <th>keep_rating</th>
      <td><p>Whether to keep rating column in ranking output.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Value for <code>type</code> in <code><a href='round_rank.html'>round_rank()</a></code>: <code>"desc"</code> or <code>"asc"</code>.</p></td>
    </tr>
    <tr>
      <th>ties</th>
      <td><p>Value for <code>ties</code> in <code><a href='round_rank.html'>round_rank()</a></code>.</p></td>
    </tr>
    <tr>
      <th>round_digits</th>
      <td><p>Value for <code>round_digits</code> in <code><a href='round_rank.html'>round_rank()</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>rate_iterative()</code> returns a <a href='http://www.rdocumentation.org/packages/tibble/topics/tibble'>tibble</a> with columns
<code>player</code> (player identifier) and <code>rating_iterative</code> (Iterative
<a href='rating-ranking.html'>ratings</a>, based on row order, by the end of competition
results). <strong>Interpretation of numbers depends on rating function
<code>rate_fun</code></strong>.</p>
<p><code>rank_iterative()</code> returns a <code>tibble</code> with columns <code>player</code>,
<code>rating_iterative</code> (if <code>keep_rating = TRUE</code>) and <code>ranking_iterative</code>
(Iterative <a href='rating-ranking.html'>ranking</a> computed with <code><a href='round_rank.html'>round_rank()</a></code> based on
specified <code>type</code>).</p>
<p><code>add_iterative_ratings()</code> returns a <a href='http://www.rdocumentation.org/packages/comperes/topics/widecr'>widecr</a> form of
<code>cr_data</code> with four rating columns added:</p><ul>
<li><p><strong>rating1Before</strong> - Rating of player1 before the game.</p></li>
<li><p><strong>rating2Before</strong> - Rating of player2 before the game.</p></li>
<li><p><strong>rating1After</strong> - Rating of player1 after the game.</p></li>
<li><p><strong>rating2After</strong> - Rating of player2 after the game.</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Iterative ratings of group of players are recomputed after every
game based on players' game scores and their ratings just before the game.
Theoretically this kind of ratings can be non-numeric and be computed on
competition results with variable number of players but they rarely do. This
package provides functions for computing iterative <strong>numeric</strong> ratings for
<a href='http://www.rdocumentation.org/packages/comperes/topics/pairgames'>pairgames</a> (competition results with games only
between two players). Error is thrown if <code>cr_data</code> is not pairgames.</p>
<p>Games in <a href='http://www.rdocumentation.org/packages/comperes/topics/widecr'>widecr</a> form are arranged in increasing order
of values in column <code>game</code> (if it is present) and processed from first to
last row.</p>
<p><code>NA</code> values in column <code>player</code> are allowed. These players are treated as
'ghosts': players of the same rating as opponent before the game. 'Ghosts'
are not actual players so they don't appear in the output of
<code>rate_iterative()</code>. For games between two 'ghosts' ratings before and after
the game are set to 0.</p>
<p>The core of the rating system is <code>rate_fun</code>. It should take the
following arguments:</p><ul>
<li><p><strong>rating1</strong> - Rating of player1 before the game.</p></li>
<li><p><strong>score1</strong> - Score of player1 in the game.</p></li>
<li><p><strong>rating2</strong> - Rating of player2 before the game.</p></li>
<li><p><strong>score2</strong> - Score of player2 in the game.</p></li>
</ul>
    <p><code>rate_fun</code> should return a numeric vector of length 2: first element being a
rating of player1 after the game, second - of player2.</p>
<p>Ratings are computed based only on games between players of interest (see
Players) and <code>NA</code> values.</p>
<p>Initial ratings should be defined with argument <code>initial_ratings</code>. It
can be:</p><ul>
<li><p>A single numeric value. In this case initial ratings for all players are
set to this value.</p></li>
<li><p>A named vector of ratings. All non-<code>NA</code> players, for which rating is
computed, should be present in its names (as character representation of
players' actual identifiers).</p></li>
<li><p>A data frame with first column representing player and second - initial
rating. It will be converted to named vector with
<a href='http://www.rdocumentation.org/packages/tibble/topics/enframe'>deframe()</a> from <code>tibble</code> package.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="players"><a class="anchor" href="#players"></a>Players</h2>

    
    <p><code>comperank</code> offers a possibility to handle certain set of players. It is done
by having <code>player</code> column (in <a href='http://www.rdocumentation.org/packages/comperes/topics/longcr'>longcr</a> format) as factor
with levels specifying all players of interest. In case of factor the result
is returned only for players from its levels. Otherwise - for all present
players.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><code class = "r"><div class='input'><span class='no'>test_rate_fun</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>rating1</span>, <span class='no'>score1</span>, <span class='no'>rating2</span>, <span class='no'>score2</span>) {
  <span class='fu'>c</span>(<span class='no'>rating1</span>, <span class='no'>rating2</span>) + ((<span class='no'>score1</span> <span class='kw'>&gt;=</span> <span class='no'>score2</span>) * <span class='fl'>2</span> - <span class='fl'>1</span>) * <span class='fu'>c</span>(<span class='fl'>1</span>, -<span class='fl'>1</span>)
}
<span class='fu'>set.seed</span>(<span class='fl'>1002</span>)
<span class='no'>cr_data</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(
  <span class='kw'>game</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>2</span>),
  <span class='kw'>player</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='kw'>times</span> <span class='kw'>=</span> <span class='fl'>4</span>),
  <span class='kw'>score</span> <span class='kw'>=</span> <span class='fu'>runif</span>(<span class='fl'>20</span>)
)
<span class='no'>cr_data</span>$<span class='no'>player</span>[<span class='fu'>c</span>(<span class='fl'>6</span>, <span class='fl'>8</span>)] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>

<span class='co'># Different settings of add_iterative_ratings</span>
<span class='fu'>add_iterative_ratings</span>(<span class='no'>cr_data</span>, <span class='no'>test_rate_fun</span>)</div><div class='output co'>#&gt; # A widecr object:
#&gt; # A tibble: 10 x 9
#&gt;     game player1 score1 player2 score2 rating1Before rating2Before rating1After
#&gt;    &lt;int&gt;   &lt;int&gt;  &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;
#&gt;  1     1       1 0.445        2  0.791             0             0           -1
#&gt;  2     2       3 0.612        4  0.227             0             0            1
#&gt;  3     3       5 0.374       NA  0.711             0             0           -1
#&gt;  4     4       2 0.972       NA  0.642             1             1            2
#&gt;  5     5       4 0.358        5  0.892            -1            -1           -2
#&gt;  6     6       1 0.616        2  0.880            -1             2           -2
#&gt;  7     7       3 0.559        4  0.499             1            -2            2
#&gt;  8     8       5 0.0569       1  0.314             0            -2           -1
#&gt;  9     9       2 0.632        3  0.827             3             2            2
#&gt; 10    10       4 0.930        5  0.511            -3            -1           -2
#&gt; # ... with 1 more variable: rating2After &lt;dbl&gt;</div><div class='input'>
<span class='fu'>add_iterative_ratings</span>(<span class='no'>cr_data</span>, <span class='no'>test_rate_fun</span>, <span class='kw'>initial_ratings</span> <span class='kw'>=</span> <span class='fl'>10</span>)</div><div class='output co'>#&gt; # A widecr object:
#&gt; # A tibble: 10 x 9
#&gt;     game player1 score1 player2 score2 rating1Before rating2Before rating1After
#&gt;    &lt;int&gt;   &lt;int&gt;  &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;
#&gt;  1     1       1 0.445        2  0.791            10            10            9
#&gt;  2     2       3 0.612        4  0.227            10            10           11
#&gt;  3     3       5 0.374       NA  0.711            10            10            9
#&gt;  4     4       2 0.972       NA  0.642            11            11           12
#&gt;  5     5       4 0.358        5  0.892             9             9            8
#&gt;  6     6       1 0.616        2  0.880             9            12            8
#&gt;  7     7       3 0.559        4  0.499            11             8           12
#&gt;  8     8       5 0.0569       1  0.314            10             8            9
#&gt;  9     9       2 0.632        3  0.827            13            12           12
#&gt; 10    10       4 0.930        5  0.511             7             9            8
#&gt; # ... with 1 more variable: rating2After &lt;dbl&gt;</div><div class='input'>
<span class='fu'>add_iterative_ratings</span>(
  <span class='no'>cr_data</span>, <span class='no'>test_rate_fun</span>,
  <span class='kw'>initial_ratings</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"1"</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='st'>"2"</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='st'>"3"</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='st'>"4"</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='st'>"5"</span> <span class='kw'>=</span> <span class='fl'>5</span>)
)</div><div class='output co'>#&gt; # A widecr object:
#&gt; # A tibble: 10 x 9
#&gt;     game player1 score1 player2 score2 rating1Before rating2Before rating1After
#&gt;    &lt;int&gt;   &lt;int&gt;  &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;
#&gt;  1     1       1 0.445        2  0.791             1             2            0
#&gt;  2     2       3 0.612        4  0.227             3             4            4
#&gt;  3     3       5 0.374       NA  0.711             5             5            4
#&gt;  4     4       2 0.972       NA  0.642             3             3            4
#&gt;  5     5       4 0.358        5  0.892             3             4            2
#&gt;  6     6       1 0.616        2  0.880             0             4           -1
#&gt;  7     7       3 0.559        4  0.499             4             2            5
#&gt;  8     8       5 0.0569       1  0.314             5            -1            4
#&gt;  9     9       2 0.632        3  0.827             5             5            4
#&gt; 10    10       4 0.930        5  0.511             1             4            2
#&gt; # ... with 1 more variable: rating2After &lt;dbl&gt;</div><div class='input'>
<span class='fu'>add_iterative_ratings</span>(
  <span class='no'>cr_data</span>, <span class='no'>test_rate_fun</span>,
  <span class='kw'>initial_ratings</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='fl'>0</span>:<span class='fl'>4</span>)
)</div><div class='output co'>#&gt; # A widecr object:
#&gt; # A tibble: 10 x 9
#&gt;     game player1 score1 player2 score2 rating1Before rating2Before rating1After
#&gt;    &lt;int&gt;   &lt;int&gt;  &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;
#&gt;  1     1       1 0.445        2  0.791             0             1           -1
#&gt;  2     2       3 0.612        4  0.227             2             3            3
#&gt;  3     3       5 0.374       NA  0.711             4             4            3
#&gt;  4     4       2 0.972       NA  0.642             2             2            3
#&gt;  5     5       4 0.358        5  0.892             2             3            1
#&gt;  6     6       1 0.616        2  0.880            -1             3           -2
#&gt;  7     7       3 0.559        4  0.499             3             1            4
#&gt;  8     8       5 0.0569       1  0.314             4            -2            3
#&gt;  9     9       2 0.632        3  0.827             4             4            3
#&gt; 10    10       4 0.930        5  0.511             0             3            1
#&gt; # ... with 1 more variable: rating2After &lt;dbl&gt;</div><div class='input'>
<span class='co'># Ratings and ranking at the end of competition results.</span>
<span class='fu'>rate_iterative</span>(<span class='no'>cr_data</span>, <span class='no'>test_rate_fun</span>)</div><div class='output co'>#&gt; # A tibble: 5 x 2
#&gt;   player rating_iterative
#&gt;    &lt;int&gt;            &lt;dbl&gt;
#&gt; 1      1               -1
#&gt; 2      2                2
#&gt; 3      3                3
#&gt; 4      4               -2
#&gt; 5      5               -2</div><div class='input'>
<span class='fu'>rank_iterative</span>(<span class='no'>cr_data</span>, <span class='no'>test_rate_fun</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"desc"</span>)</div><div class='output co'>#&gt; # A tibble: 5 x 2
#&gt;   player ranking_iterative
#&gt;    &lt;int&gt;             &lt;dbl&gt;
#&gt; 1      1               3  
#&gt; 2      2               2  
#&gt; 3      3               1  
#&gt; 4      4               4.5
#&gt; 5      5               4.5</div><div class='input'>
<span class='fu'>rank_iterative</span>(<span class='no'>cr_data</span>, <span class='no'>test_rate_fun</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"desc"</span>, <span class='kw'>keep_rating</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; # A tibble: 5 x 3
#&gt;   player rating_iterative ranking_iterative
#&gt;    &lt;int&gt;            &lt;dbl&gt;             &lt;dbl&gt;
#&gt; 1      1               -1               3  
#&gt; 2      2                2               2  
#&gt; 3      3                3               1  
#&gt; 4      4               -2               4.5
#&gt; 5      5               -2               4.5</div><div class='input'>
</div></code></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#players">Players</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Evgeni Chasnovski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

