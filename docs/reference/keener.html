<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Keener method — keener • comperes</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  <script src="../extra.js"></script>

<meta property="og:title" content="Keener method — keener" />
<meta property="og:description" content="Functions to compute rating and ranking
using Keener method." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">comperes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/methods-overview.html">Methods Overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/echasnovski/comperank">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Keener method</h1>
    <small class="dont-index">Source: <a href='https://github.com/echasnovski/comperank/blob/master/R/keener.R'><code>R/keener.R</code></a></small>
    <div class="hidden name"><code>keener.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions to compute <a href='rating-ranking.html'>rating</a> and <a href='rating-ranking.html'>ranking</a>
using Keener method.</p>
    </div>

    <pre class="usage"><code class = "r"><span class='fu'>rate_keener</span>(<span class='no'>cr_data</span>, <span class='no'>...</span>, <span class='kw'>fill</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>force_nonneg_h2h</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>skew_fun</span> <span class='kw'>=</span> <span class='no'>skew_keener</span>, <span class='kw'>normalize_fun</span> <span class='kw'>=</span> <span class='no'>normalize_keener</span>, <span class='kw'>eps</span> <span class='kw'>=</span> <span class='fl'>0.001</span>)

<span class='fu'>rank_keener</span>(<span class='no'>cr_data</span>, <span class='no'>...</span>, <span class='kw'>fill</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>force_nonneg_h2h</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>skew_fun</span> <span class='kw'>=</span> <span class='no'>skew_keener</span>, <span class='kw'>normalize_fun</span> <span class='kw'>=</span> <span class='no'>normalize_keener</span>, <span class='kw'>eps</span> <span class='kw'>=</span> <span class='fl'>0.001</span>,
  <span class='kw'>keep_rating</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>ties</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"average"</span>, <span class='st'>"first"</span>, <span class='st'>"last"</span>, <span class='st'>"random"</span>, <span class='st'>"max"</span>,
  <span class='st'>"min"</span>), <span class='kw'>round_digits</span> <span class='kw'>=</span> <span class='fl'>7</span>)

<span class='fu'>skew_keener</span>(<span class='no'>x</span>)

<span class='fu'>normalize_keener</span>(<span class='no'>mat</span>, <span class='no'>cr_data</span>)</code></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cr_data</th>
      <td><p>Competition results in format ready for
<a href='https://rdrr.io/pkg/comperes/man/longcr.html'>as_longcr()</a>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Head-to-Head expression (see <a href='https://rdrr.io/pkg/comperes/man/h2h_mat.html'>h2h_mat()</a>).</p></td>
    </tr>
    <tr>
      <th>fill</th>
      <td><p>A single value to use instead of NA for missing pairs.</p></td>
    </tr>
    <tr>
      <th>force_nonneg_h2h</th>
      <td><p>Whether to force nonnegative values in Head-to-Head
matrix.</p></td>
    </tr>
    <tr>
      <th>skew_fun</th>
      <td><p>Skew function.</p></td>
    </tr>
    <tr>
      <th>normalize_fun</th>
      <td><p>Normalization function.</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>Coefficient for forcing irreducibility.</p></td>
    </tr>
    <tr>
      <th>keep_rating</th>
      <td><p>Whether to keep rating column in ranking output.</p></td>
    </tr>
    <tr>
      <th>ties</th>
      <td><p>Value for <code>ties</code> in <code><a href='round_rank.html'>round_rank()</a></code>.</p></td>
    </tr>
    <tr>
      <th>round_digits</th>
      <td><p>Value for <code>round_digits</code> in <code><a href='round_rank.html'>round_rank()</a></code>.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Argument for <code>skew_keener()</code>.</p></td>
    </tr>
    <tr>
      <th>mat</th>
      <td><p>Argument for <code>normalize_keener()</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>rate_keener()</code> returns a <a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a> with columns
<code>player</code> (player identifier) and <code>rating_keener</code> (Keener
<a href='rating-ranking.html'>rating</a>). Sum of all ratings should be equal to 1. <strong>Bigger
value indicates better player performance</strong>.</p>
<p><code>rank_keener()</code> returns a <code>tibble</code> with columns <code>player</code>, <code>rating_keener</code> (if
<code>keep_rating = TRUE</code>) and <code>ranking_keener</code> (Keener <a href='rating-ranking.html'>ranking</a>
computed with <code><a href='round_rank.html'>round_rank()</a></code>).</p>
<p><code>skew_keener()</code> returns skewed vector of the same length as <code>x</code>.</p>
<p><code>normalize_keener()</code> returns normalized matrix with the same dimensions as
<code>mat</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Keener rating method is based on Head-to-Head matrix of the
competition results. Therefore it can be used for competitions with
variable number of players. Its algorithm is as follows:</p><ol>
<li><p>Compute Head-to-Head matrix of competition results based on Head-to-Head
expression supplied in <code>...</code> (see <a href='https://rdrr.io/pkg/comperes/man/h2h_mat.html'>h2h_mat()</a> for
technical details and section <strong>Design of Head-to-Head values</strong> for design
details). Head-to-Head values are computed based only on the games between
players of interest (see Players). Ensure that there are no <code>NA</code>s by using
<code>fill</code> argument. If <code>force_nonneg_h2h</code> is <code>TRUE</code> then the minimum value is
subtracted (in case some Head-to-Head value is strictly negative).</p></li>
<li><p>Update raw Head-to-Head values (denoted as S) with the pair-normalization:
a_ij = (S_ij + 1) / (S_ij + S_ji + 2). This step should make comparing
different players more reasonable.</p></li>
<li><p>Skew Head-to-Head values with applying <code>skew_fun</code> to them. <code>skew_fun</code>
should take numeric vector as only argument. It should return skewed vector.
The default skew function is <code>skew_keener()</code>. This step should make abnormal
results not very abnormal. To omit this step supply <code>skew_fun = NULL</code>.</p></li>
<li><p>Normalize Head-to-Head values with <code>normalize_fun</code> using <code>cr_data</code>.
<code>normalize_fun</code> should take Head-to-Head matrix as the first argument and
<code>cr_data</code> as second. It should return normalized matrix. The default
normalization is <code>normalize_keener()</code> which divides Head-to-Head value of
'player1'-'player2' matchup divided by the number of games played by
'player1' (error is thrown if there are no games). This step should take into
account possibly not equal number of games played by players. To omit this
step supply <code>normalize_keener = NULL</code>.</p></li>
<li><p>Add small value to Head-to-Head matrix to ensure its irreducibility. If
all values are strictly positive then this step is omitted. In other case
small value is computed as the smallest non-zero Head-to-Head value
multiplied by <code>eps</code>. This step is done to ensure applicability of
Perron-Frobenius theorem.</p></li>
<li><p>Compute Perron-Frobenius vector of the resultant matrix, i.e. the strictly
positive real eigenvector (which values sum to 1) for eigenvalue (which is
real) of the maximum absolute value. This vector is Keener rating vector.</p></li>
</ol>

<p>If using <code>normalize_keener()</code> in normalization step, ensure to analyze
players which actually played games (as division by a number of played games
is made). If some player didn't play any game, en error is thrown.</p>
    <h2 class="hasAnchor" id="design-of-head-to-head-values"><a class="anchor" href="#design-of-head-to-head-values"></a>Design of Head-to-Head values</h2>

    


<p>Head-to-Head values in these functions are assumed to follow the property
which can be <em>equivalently</em> described in two ways:</p><ul>
<li><p>In terms of <a href='https://rdrr.io/pkg/comperes/man/h2h_mat.html'>matrix format</a>: <strong>the more Head-to-Head
value in row <em>i</em> and column <em>j</em> the better player from row <em>i</em> performed than
player from column <em>j</em></strong>.</p></li>
<li><p>In terms of <a href='https://rdrr.io/pkg/comperes/man/h2h_long.html'>long format</a>: <strong>the more Head-to-Head
value the better player1 performed than player2</strong>.</p></li>
</ul>

<p>This design is chosen because in most competitions the goal is to score
<strong>more points</strong> and not less. Also it allows for more smooth use of
<a href='https://rdrr.io/pkg/comperes/man/h2h_funs.html'>h2h_funs</a> from <code>comperes</code> package.</p>
    <h2 class="hasAnchor" id="players"><a class="anchor" href="#players"></a>Players</h2>

    


<p><code>comperank</code> offers a possibility to handle certain set of players. It is done
by having <code>player</code> column (in <a href='https://rdrr.io/pkg/comperes/man/longcr.html'>longcr</a> format) as factor
with levels specifying all players of interest. In case of factor the result
is returned only for players from its levels. Otherwise - for all present
players.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>James P. Keener (1993) <em>The Perron-Frobenius theorem and the
ranking of football teams</em>. SIAM Review, 35(1):80–93, 1993.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><code class = "r"><div class='input'><span class='fu'>rate_keener</span>(<span class='no'>ncaa2005</span>, <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>score1</span>))</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 5 x 2</span><span>
#&gt;   player rating_keener
#&gt;   </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>          </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> Duke          0.067</span><span style='text-decoration: underline;'>1</span><span>
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> Miami         0.351 
#&gt; </span><span style='color: #BCBCBC;'>3</span><span> UNC           0.158 
#&gt; </span><span style='color: #BCBCBC;'>4</span><span> UVA           0.161 
#&gt; </span><span style='color: #BCBCBC;'>5</span><span> VT            0.263 </div><div class='input'>
<span class='fu'>rank_keener</span>(<span class='no'>ncaa2005</span>, <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>score1</span>))</div><div class='output co'>#&gt; </span><span style='color: #949494;'># A tibble: 5 x 2</span><span>
#&gt;   player ranking_keener
#&gt;   </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>           </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> Duke                5
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> Miami               1
#&gt; </span><span style='color: #BCBCBC;'>3</span><span> UNC                 4
#&gt; </span><span style='color: #BCBCBC;'>4</span><span> UVA                 3
#&gt; </span><span style='color: #BCBCBC;'>5</span><span> VT                  2</div><div class='input'>
<span class='fu'>rank_keener</span>(<span class='no'>ncaa2005</span>, <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>score1</span>), <span class='kw'>keep_rating</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; </span><span style='color: #949494;'># A tibble: 5 x 3</span><span>
#&gt;   player rating_keener ranking_keener
#&gt;   </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>          </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>          </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> Duke          0.067</span><span style='text-decoration: underline;'>1</span><span>              5
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> Miami         0.351               1
#&gt; </span><span style='color: #BCBCBC;'>3</span><span> UNC           0.158               4
#&gt; </span><span style='color: #BCBCBC;'>4</span><span> UVA           0.161               3
#&gt; </span><span style='color: #BCBCBC;'>5</span><span> VT            0.263               2</div><div class='input'>
<span class='co'># Impact of skewing</span>
<span class='fu'>rate_keener</span>(<span class='no'>ncaa2005</span>, <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>score1</span>), <span class='kw'>skew_fun</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</div><div class='output co'>#&gt; </span><span style='color: #949494;'># A tibble: 5 x 2</span><span>
#&gt;   player rating_keener
#&gt;   </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>          </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> Duke          0.089</span><span style='text-decoration: underline;'>8</span><span>
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> Miami         0.295 
#&gt; </span><span style='color: #BCBCBC;'>3</span><span> UNC           0.165 
#&gt; </span><span style='color: #BCBCBC;'>4</span><span> UVA           0.189 
#&gt; </span><span style='color: #BCBCBC;'>5</span><span> VT            0.261 </div><div class='input'>
<span class='co'># Impact of normalization.</span>
<span class='fu'>rate_keener</span>(<span class='no'>ncaa2005</span>[-(<span class='fl'>1</span>:<span class='fl'>2</span>), ], <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>score1</span>))</div><div class='output co'>#&gt; </span><span style='color: #949494;'># A tibble: 5 x 2</span><span>
#&gt;   player rating_keener
#&gt;   </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>          </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> Duke           0.162
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> Miami          0.335
#&gt; </span><span style='color: #BCBCBC;'>3</span><span> UNC            0.136
#&gt; </span><span style='color: #BCBCBC;'>4</span><span> UVA            0.149
#&gt; </span><span style='color: #BCBCBC;'>5</span><span> VT             0.219</div><div class='input'>
<span class='fu'>rate_keener</span>(<span class='no'>ncaa2005</span>[-(<span class='fl'>1</span>:<span class='fl'>2</span>), ], <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>score1</span>), <span class='kw'>normalize_fun</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</div><div class='output co'>#&gt; </span><span style='color: #949494;'># A tibble: 5 x 2</span><span>
#&gt;   player rating_keener
#&gt;   </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>          </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> Duke           0.128
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> Miami          0.300
#&gt; </span><span style='color: #BCBCBC;'>3</span><span> UNC            0.153
#&gt; </span><span style='color: #BCBCBC;'>4</span><span> UVA            0.161
#&gt; </span><span style='color: #BCBCBC;'>5</span><span> VT             0.257</div><div class='input'>
</div></span></code></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#design-of-head-to-head-values">Design of Head-to-Head values</a></li>
      <li><a href="#players">Players</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Evgeni Chasnovski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


